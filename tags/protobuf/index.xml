<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>protobuf on zhangzw</title>
    <link>https://blog.k1s.club/tags/protobuf/</link>
    <description>Recent content in protobuf on zhangzw</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>zh-hans</language>
    <copyright>This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.</copyright>
    <lastBuildDate>Sat, 23 May 2020 15:07:37 +0800</lastBuildDate><atom:link href="https://blog.k1s.club/tags/protobuf/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>Proto 代码到底放哪里？</title>
      <link>https://blog.k1s.club/posts.bak/where-is-proto/</link>
      <pubDate>Sat, 23 May 2020 15:07:37 +0800</pubDate>
      
      <guid>https://blog.k1s.club/posts.bak/where-is-proto/</guid>
      <description>虽然公司已经从大单体切换为微服务化有一定的年头了，但一些细节方面的处理总会有不同的人有不同的看法，这其中一个讨论点，就是 Proto 这个 IDL 的代码到底放在哪里？
目前来看，一共有如下方案， 我们一起来探讨一下 Proto 的存储方式和对应带来的优缺点。
方案一：存放在代码仓库 直接将项目所依赖到的所有 Proto 文件都存放在 proto/ 目录下，不经过开发工具的自动拉取和发布：
缺点   项目所有依赖的 Proto 都存储在代码仓库下，因此所有依赖 Proto 都需要人工的向其它业务组 “要” 来，再放到 proto/ 目录下，人工介入极度麻烦。
  Proto 升级和变更，经常要重复第一步，沟通成本高。
  优点   项目所有依赖的 Proto 都存储在代码仓库下，因此不涉及个人开仓库权限的问题。
  多 Proto 的切换开销减少，因为都在代码仓库下，不需要看这看那。
  方案二：独立仓库 独立仓库存储是我们最早采取的方式，也就是每个服务对应配套一个 Proto 仓库：
这个方案的好处就是可以独立管理所有 Proto 仓库，并且权限划分清晰。但最大的优点也是最大的缺点，因为一个服务会依赖多个 Proto 仓库，并且存在跨业务组调用的情况：
如上图所示，svc-user 服务分别依赖了三块 Proto 仓库，分别是自己组的、业务组 A、业务组 B 总共的 6 个 Proto 仓库。
缺点  假设你是一个新入职的开发人员，那么你就需要找不同的业务组申请不同的仓库权限，非常麻烦。如果没有批量赋权工具，也没有管理者权限，那么就需要一个个赋权，非常麻烦。 在运行服务的时候，你需要将所有相关联的 Proto 仓库拉取下来，如果没有工具做半自动化的支持，麻烦程度无法忍受。  优点   使得安全性较高（但 IDL 本身没有太多的秘密）。</description>
    </item>
    
  </channel>
</rss>
